<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¥ç§˜å¯†å®¤è§£ç¢¼å™¨</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --accent: #8b5cf6; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: #f1f5f9; display: flex; justify-content: center; margin: 0; padding-top: 30px; }
        .container { background: var(--card); padding: 30px; border-radius: 24px; width: 90%; max-width: 400px; text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.5); border: 1px solid #334155; }
        
        /* å˜²è«·åœ–ç‰‡æ¨£å¼ */
        .meme-img { width: 100%; border-radius: 12px; margin: 15px 0; border: 2px solid var(--accent); }
        
        h2 { color: var(--accent); margin-top: 0; }
        .hidden { display: none; }
        input { width: 100%; padding: 14px; margin: 15px 0; border: 2px solid #334155; border-radius: 12px; background: #0f172a; color: white; font-size: 16px; box-sizing: border-box; text-align: center; }
        input:focus { border-color: var(--accent); outline: none; }
        button { width: 100%; padding: 14px; background: var(--accent); color: white; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; font-size: 16px; transition: 0.3s; }
        button:active { transform: scale(0.95); }
        
        #reader { width: 100%; border-radius: 12px; overflow: hidden; margin-top: 15px; }
        #display-result { font-size: 38px; margin: 25px 0; color: #4ade80; font-weight: 900; text-shadow: 0 0 15px rgba(74, 222, 128, 0.3); }
        .logout-link { color: #64748b; font-size: 13px; margin-top: 25px; cursor: pointer; text-decoration: underline; }
    </style>
</head>
<body>

<div class="container">
    <div id="login-zone" class="hidden">
        <h2>ğŸ§ å–”ï¼Ÿæƒ³å·çœ‹ï¼Ÿ</h2>
        <p>ã€Œå’¦ï¼Œé›£é“ä½ ä»¥ç‚ºæˆåŠŸè§£å¯†äº†å—ï¼Ÿã€</p>
        
        <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNHJ4emZ5Nnd6dzZ6ZzR6ZzR6ZzR6ZzR6ZzR6ZzR6ZzR6ZzR6JmVwPXYxX2ludGVybmFsX2dpZl9ieV9pZCZjdD1n/26ghbWoXv3G6ypo8o/giphy.gif" class="meme-img" alt="Meme">
        
        <p style="font-size: 14px; color: #94a3b8;">åˆ¥ç™½è²»åŠ›æ°£äº†ï¼Œä¹–ä¹–ç¿»è«–èªå§ã€‚<br>ï¼ˆæˆ–æ˜¯å»æ‰¾å¤§ç¾å¥³å¤§å¸¥å“¥ä¾†å¹«å¹«ä½ ï¼‰</p>
        
        <input type="password" id="pw" placeholder="é€šé—œæš—è™Ÿ...">
        <button onclick="login()">é©—è­‰èº«ä»½</button>
    </div>

    <div id="main-zone" class="hidden">
        <div id="scan-view">
            <h2>ğŸ” æƒææ¬Šé™å·²é–‹å•Ÿ</h2>
            <p style="color:#94a3b8">ç¾åœ¨ä½ å¯ä»¥åˆæ³•çš„å·çœ‹äº†</p>
            <div id="reader"></div>
        </div>
        
        <div id="result-view" class="hidden">
            <h2>è§£å¯†çµæœå¦‚ä¸‹</h2>
            <div id="display-result">--</div>
            <button onclick="showScanner()">ç¹¼çºŒæƒä¸‹ä¸€å€‹</button>
        </div>

        <div class="logout-link" onclick="logout()">ç™»å‡ºï¼ˆæƒ³å†æ¬¡è¢«æ¶æ„é»é€™è£¡ï¼‰</div>
    </div>
</div>

<script>
    const MASTER_PW = "1234"; // ä½ çš„å¯†ç¢¼
    
    // 50 çµ„å°ç…§è¡¨
    const MAPPING = {
        "k8v2": "ç·¨è™Ÿ 01", "m7x9": "ç·¨è™Ÿ 02", "r4w5": "ç·¨è™Ÿ 03", "t1n6": "ç·¨è™Ÿ 04", "b9z3": "ç·¨è™Ÿ 05",
        "p2q8": "ç·¨è™Ÿ 06", "h5j4": "ç·¨è™Ÿ 07", "g3k1": "ç·¨è™Ÿ 08", "f7s9": "ç·¨è™Ÿ 09", "d2m4": "ç·¨è™Ÿ 10",
        "c6v8": "ç·¨è™Ÿ 11", "x1b3": "ç·¨è™Ÿ 12", "n9m5": "ç·¨è™Ÿ 13", "l4k2": "ç·¨è™Ÿ 14", "j7h1": "ç·¨è™Ÿ 15",
        "g9f3": "ç·¨è™Ÿ 16", "d5s8": "ç·¨è™Ÿ 17", "a2p4": "ç·¨è™Ÿ 18", "q6w1": "ç·¨è™Ÿ 19", "e9r3": "ç·¨è™Ÿ 20",
        "t5y7": "ç·¨è™Ÿ 21", "u1i8": "ç·¨è™Ÿ 22", "o4p2": "ç·¨è™Ÿ 23", "a9s3": "ç·¨è™Ÿ 24", "d7f1": "ç·¨è™Ÿ 25",
        "g6h8": "ç·¨è™Ÿ 26", "j2k4": "ç·¨è™Ÿ 27", "l9z3": "ç·¨è™Ÿ 28", "x5c7": "ç·¨è™Ÿ 29", "v1b8": "ç·¨è™Ÿ 30",
        "n4m2": "ç·¨è™Ÿ 31", "q9w3": "ç·¨è™Ÿ 32", "e7r1": "ç·¨è™Ÿ 33", "t6y8": "ç·¨è™Ÿ 34", "u2i4": "ç·¨è™Ÿ 35",
        "o9p3": "ç·¨è™Ÿ 36", "a5s7": "ç·¨è™Ÿ 37", "d1f8": "ç·¨è™Ÿ 38", "g4h2": "ç·¨è™Ÿ 39", "j9k3": "ç·¨è™Ÿ 40",
        "l7z1": "ç·¨è™Ÿ 41", "x6c8": "ç·¨è™Ÿ 42", "v2b4": "ç·¨è™Ÿ 43", "n5m7": "ç·¨è™Ÿ 44", "q1w8": "ç·¨è™Ÿ 45",
        "e4r2": "ç·¨è™Ÿ 46", "t9y3": "ç·¨è™Ÿ 47", "u7i1": "ç·¨è™Ÿ 48", "o6p8": "ç·¨è™Ÿ 49", "a2s4": "ç·¨è™Ÿ 50"
    };

    let html5QrCode;

    window.onload = function() {
        if (localStorage.getItem('isLoggedIn') === 'true') {
            showMain();
            checkUrlParam();
        } else {
            document.getElementById('login-zone').classList.remove('hidden');
        }
    };

    function login() {
        if (document.getElementById('pw').value === MASTER_PW) {
            localStorage.setItem('isLoggedIn', 'true');
            location.reload();
        } else {
            alert("ç¬‘æ­»ï¼Œå¯†ç¢¼éƒ½æ‰“ä¸å°å—ï¼Ÿ");
            document.getElementById('pw').value = "";
        }
    }

    function logout() {
        localStorage.removeItem('isLoggedIn');
        location.reload();
    }

    function showMain() {
        document.getElementById('main-zone').classList.remove('hidden');
        startScanner();
    }

    function startScanner() {
        html5QrCode = new Html5Qrcode("reader");
        html5QrCode.start(
            { facingMode: "environment" }, 
            { fps: 10, qrbox: 250 },
            (decodedText) => {
                try {
                    const url = new URL(decodedText);
                    const id = url.searchParams.get("id");
                    processCode(id || decodedText);
                } catch(e) {
                    processCode(decodedText);
                }
            }
        ).catch(err => {
            console.error(err);
        });
    }

    function checkUrlParam() {
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');
        if (id) processCode(id);
    }

    function processCode(code) {
        const result = MAPPING[code] || "æŠ“åˆ°äº†ï¼é€™ä»£ç¢¼æ˜¯å‡çš„å§ï¼Ÿ";
        document.getElementById('display-result').innerText = result;
        document.getElementById('scan-view').classList.add('hidden');
        document.getElementById('result-view').classList.remove('hidden');
        if (navigator.vibrate) navigator.vibrate(100);
    }

    function showScanner() {
        document.getElementById('result-view').classList.add('hidden');
        document.getElementById('scan-view').classList.remove('hidden');
        window.history.replaceState({}, document.title, window.location.pathname);
    }
</script>
</body>
</html>